# HiChIP Overdispersion and Bias Jointly Emulating Tool (OBJECT)

## Introduction
### HiChIP Bias

HiChIP was known to have bias from Hi-C (distance scaling, <img src="https://latex.codecogs.com/svg.latex?\normal&space;L" />) and ChIP (varing coverage at anchors, <img src="https://latex.codecogs.com/svg.latex?\normal&space;D" />). Existing interaction calling tools, e.g. MANGO model based hichipper, FitHiChIP, MAPS, had been focused on correcting the HiChIP bias to generate a background model describing the expected count/probability of the anchor pairs. Parameterizing on the expected, the distribution of the observed count is calculating from binomial distribution by MANGO/hichipper, poisson distribution by FitHiChIP, or zero truncated poisson from MAPS.

### Overdispersion

To choose an underlying statistical model for observed count distribution, we plots the mean vs. variance relationship, conditioning on the HiChIP bias, <img src="https://latex.codecogs.com/svg.latex?\normal&space;L"/> and <img src="https://latex.codecogs.com/svg.latex?\normal&space;D"/>. We found that the data has substantial overdispersion which is violating the poisson distribution. Negative binomial (<img src="https://latex.codecogs.com/svg.latex?\normal&space;NB"/>) or zero-inflated poisson distribution (<img src="https://latex.codecogs.com/svg.latex?\normal&space;ZIP"/>) is usually used to model overdispersed data. We fit the data using GLM framework discuss below to find the parameters for <img src="https://latex.codecogs.com/svg.latex?\normal&space;NB"/> and <img src="https://latex.codecogs.com/svg.latex?\normal&space;ZIP"/>. Then the mean-var relationship of the distribution were calculated. We found that <img src="https://latex.codecogs.com/svg.latex?\normal&space;ZIP"/> model-driven fitting approximates well to the "smooth.spline" data-driven fitting for the mean-var relationship of the HiChIP data. We reason that the power of <img src="https://latex.codecogs.com/svg.latex?\normal&space;ZIP"/> distribution to fit the HiChIP data is likely due to the sparsity inherited from conformation capture experiments.

### General Linear Model (GLM)

To integrate the HiChIP bias and overdispersion features, we use the GLM model where poisson mean background signal <img src="https://latex.codecogs.com/svg.latex?\normal&space;\lambda_i" /> is determined by independent variables, <img src="https://latex.codecogs.com/svg.latex?\normal&space;L_i"/> and <img src="https://latex.codecogs.com/svg.latex?\normal&space;D_i"/>, and the observed count <img src="https://latex.codecogs.com/svg.latex?\normal&space;y_i" title="\large y_i" /> is generated by <img src="https://latex.codecogs.com/svg.latex?\normal&space;ZIP"/>, the combinated distribution of poisson distribution and the probability of being structual zeros corresponding to parameters <img src="https://latex.codecogs.com/svg.latex?\normal&space;\lambda_i"/> and <img src="https://latex.codecogs.com/svg.latex?\normal&space;\pi"/> respectively.

<p align="center"><img src="https://latex.codecogs.com/svg.latex?ln(\lambda_i)&space;=&space;\beta_0&space;&plus;&space;\beta_1ln(L_i)&space;&plus;&space;\beta_2ln(D_i)" /></p>
<p align="center"><img src="https://latex.codecogs.com/svg.latex?y_i&space;\sim&space;ZeroInflatedPoisson(\lambda_i,&space;\pi)" /></p>

## Installation
We recommend installing the tool and its dependency in a virtual environment (such as one by conda). After creating the virtual environment, switch inside it and clone the repo. Go into the repo directory and run `pip` to install the package. (Please refer to setup.py file for the list of dependent python pacakges.)
```
pip install hichip_obj
```